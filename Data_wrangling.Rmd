---
title: "Data wrangling"
output:
  html_document:
    toc: true
    toc_float: true
    collapsed: false
    number_sections: false
    toc_depth: 3
    theme: paper
    highlight: tango
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(message=FALSE,warning=FALSE, cache=TRUE)
```

```{r xaringanExtra-clipboard, echo=FALSE}
xaringanExtra::use_clipboard()
```

Download the script for this session at the link below (Click Link --> Right Click on Page --> Save Page As):

* [Session 3 and 4: data wrangling R script](https://raw.githubusercontent.com/jdmwhite/R_Workshop/main/scripts/3_Data_Wrangling.R)

Data wrangling involves cleaning, (re)structuring and transforming the data. This allows us to analyse and visualise data more easily.

# Part 1: Data cleaning

In this section we will look at turning messy data into data that we can understand. We need the data cleaned before we can structure it so that we do not have to add and remove spaces, periods and duplicates when we are structuring the data.

We will start by installing packages. You might already have these packages. If you already have these packages, skip this step.

```{r eval=FALSE}
#### Install packages ----
install.packages('tidyverse') # dplyr, tidyr and readxl 
install.packages('janitor') # cleaning names
```

Load your libraries:

```{r, message = FALSE, warning=FALSE}
#### Load libraries ----
library(readxl)
library(tidyverse)
library(janitor)
library(dplyr)
```

## Import data

Data can be imported from .txt, .csv or Excel (to name a few common file types) into R. For this workshop we will be importing from .xlsx (Excel file).

```{r, message = FALSE, warning=FALSE}
#### Loading the data ----
photographer_names <- read_excel("data/raw/photographer_names.xlsx")
#photographer_names <- read.csv("path/filename.csv)

```

We can see above, the structure of the data that we have loaded. Now we can start cleaning the data

## Inspect data

Before we decide how to clean the data, we need to know how they are structured. We want to find out information about the rows(observations) and columns(variables). This will give us an idea of how we can clean. manipulate and structure the data before visualisation and analysis.

```{r, message = FALSE, warning=FALSE}
#### Inspecting the data
View(photographer_names)
names(photographer_names)
str(photographer_names)
head(photographer_names)
tail(photographer_names)
```

## Prepare data

Preparing the data allows you to see duplicates, extra letters, symbols and other attributes in data sets (dataframes) that may make it hard to combine, read, or understand data.

```{r, message = FALSE, warning=FALSE}
#### Clean and structure data
photographers <- clean_names(photographer_names) #The new names are unique
photographers <- rename(photographers, initial_date = date_4)
photographers <- rename(photographers, repeat_date = date_6)
names(photographers)
#### remove or add rows
rows_delete (photographers, tibble(site_number = 1100)) #you can match the delete function to any specific row
rows_insert (photographers, tibble (site_number = 9)) #The new row is added.
#### remove or add columns
select(photographers,-initial_date) #removes column
photographers <- mutate (photographers, location = " ") #adds a new column

```

# Part 2: Data transformation

Data transformation involves changing the structure of data.This involves adding new columns with computed data or joining a new column/row to the dataframe. We did some transformations above. Here are a few more.

```{r, message = FALSE, warning=FALSE}
#### Clean and structure data
pull(photographers, latitude)
select(photographers, site_location, altitude_m)

```


